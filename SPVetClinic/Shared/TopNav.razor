@inject Microsoft.AspNetCore.Components.NavigationManager NavigationManager

<nav class="topnav" id="topnav">
    <div class="logo-container">
        <a href="@NavigationManager.BaseUri" class="logo-text">
            <img src="images/logo_pequeno_vet_clinic.png" alt="San Pablo Vet Cl√≠nic" class="logo-img" />
        </a>
    </div>

    <div class="nav-links" id="navLinks">
        <a href="#home" class="nav-link">
            <span class="nav-link-text">Inicio</span>
        </a>
        <a href="#services" class="nav-link">
            <span class="nav-link-text">Servicios</span>
        </a>
        <a href="#specialists" class="nav-link">
            <span class="nav-link-text">Especialistas</span>
        </a>
        <a href="#mobile-vet" class="nav-link nav-highlight">
            <span class="nav-icon">üöê</span>
            <span class="nav-link-text">Vet M√≥vil</span>
        </a>
        <a href="@AppConstants.Clinic.BookingUrl" target="_blank" class="nav-link nav-cta">
            <span class="nav-icon">üìÖ</span>
            <span class="nav-link-text">Agendar Hora</span>
        </a>
    </div>

    <button class="mobile-menu-btn" onclick="toggleMobileMenu()" aria-label="Men√∫">
        <span></span>
        <span></span>
        <span></span>
    </button>
</nav>

<script>
    function toggleMobileMenu() {
        document.getElementById('navLinks').classList.toggle('active');
        document.querySelector('.mobile-menu-btn').classList.toggle('active');
    }

    // Smart navigation - handles anchors that point to sections (works with base href)
    (function () {
        const baseHref = document.querySelector('base')?.getAttribute('href') || '/';
        const normalizedBase = baseHref.endsWith('/') ? baseHref : baseHref + '/';

        document.querySelectorAll('a[href*="#"]').forEach(anchor => {
            const hrefAttr = anchor.getAttribute('href') || '';
            // Only consider anchors that are internal (either fragment-only or include the base href)
            if (!hrefAttr.startsWith('#') && !hrefAttr.includes(normalizedBase)) return;

            anchor.addEventListener('click', function (e) {
                const href = this.getAttribute('href') || '';
                const parts = href.split('#');
                const targetId = parts[parts.length - 1];
                const targetElement = document.getElementById(targetId);

                const currentPath = window.location.pathname.endsWith('/') ? window.location.pathname : window.location.pathname + '/';

                if ((href.startsWith('#') && targetElement) || (currentPath === normalizedBase && targetElement)) {
                    e.preventDefault();
                    targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }

                // Close mobile menu if open
                const navLinks = document.getElementById('navLinks');
                if (navLinks) navLinks.classList.remove('active');
                const btn = document.querySelector('.mobile-menu-btn');
                if (btn) btn.classList.remove('active');
            });
        });
    })();
</script>